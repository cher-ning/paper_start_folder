---
title: "Emergency Homeless Shelter Availabilities Across Toronto"
author: "Cher Ning-Li"
thanks: "Code and data are available at: https://github.com/cher-ning/shelter_occupancies"
date: today
date-format: long
abstract: "In this paper I analyze the occupancy and capacity of emergency homeless shelters across Toronto."
#TODO Complete abstract after paper.
format: pdf
number-sections: true
toc: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)

data <- read_csv(here::here("data/analysis_data/analysis_data.csv"))
```


# Introduction

Much like many other large cities around the world, Toronto is facing a homelessness crisis that seems to be ever-increasing. Whether it is because of environmental factors such as rising housing prices and lack of employment opportunities, or other issues such as drug abuse and mental health struggles, the homeless population of Toronto has risen to an alarming 10,811 in May 2023 [@cbcArticle]. The city council has recognized the urgency of this problem, declaring homelessness an emergency, and pledged their full efforts towards helping the homeless population move into safe homes [@cbcArticle]. Since then, the city of Toronto has focussed on securing more financial support from the provincial and federal government, requesting up to $25 million to fund various housing projects. Notably, the Canada-Ontario Housing Benefit (COHB) aimed to move 1,600-2,000 households access and transition into permanent housing in 2023-2024 [@cbcArticle].

So, how did these efforts turn out? Analyzing Toronto's shelter occupancy data from 2024, we do not see optimistic results. Average occupancy rate of emergency shelters per night remains at 99%, with no significant decrease across the months [@shelterDataset]. Despite the evident high demand, there is even a decrease, albeit small, in shelters' funding capacity over the months [@shelterDataset].

In this paper, emergency shelter occupancy and availability will be compared across different months as well as different regions of Toronto to search for patterns or fluctutations in demand. The region of each shelter will be determined by its forward sorting area (FSA) code, or the first three digits of its postal code. As well, the regions that observe the highest frequency of failing to make efficient use of funding are identified as potential problem areas; further investigation into potential causes would be beneficial to understand if there are improvements that can be made so that the limited available funding can be maximized.

To achieve this, @sec-data will introduce the Toronto Shelter & Support Services dataset used for the present analysis and the data cleaning methods applied. The following @sec-discussion will then go more into depth to apply context to the patterns present in the data, aiming to understand the scope and urgency of the issues at hand. 

# Data {#sec-data}

## Overview {#data-overview}

The dataset used for analysis is of shelter occupancy in the year 2024 [@shelterDataset], from Open Data Toronto [@opendatatoronto]. The data is updated daily by the Toronto Shelter & Support Services and has the Open Data License (@sec-license). However, one limitation it faces is that it is unaudited, therefore there are limited verification methods to ensure that the shelter programs' records are accurate to their actual situation. 

All shelters in this dataset are classified as either Emergency or Transitional programs, with Transitional locations providing more specialized programming and being exclusively offered to eligible individuals [@shelterDataset]. With consideration for the greater accessibility of Emergency programs to the entire homeless population as well as the greater number of them shelters compared to Transitional, this analysis will focus on Emergency programs only [@shelterDataset]. As well, all recorded shelters either measure capacity based on number of beds or rooms; similarly, this analysis will focus only on bed-based capacity shelters due to its greater prevalence [@shelterDataset]. This means that all entries pertaining to non-Toronto based, Transitional type, or room-based capacity shelters were not considered in this analysis. 

With the remaining data entries, the variables of interest were the shelter's location, funding capacity, actual capacity, occupied beds, unoccupied beds, unavailable beds, and occupancy rate. Funding capacity refers to the maximum number of beds the location is able to offer, and represents the sum of actual capacity and unavailable beds. Unavailable beds refers to the number of spaces that are out of service due to logistical reasons [@shelterDataset]. Actual capacity represents the number of beds that are usable per night, and should be the sum of occupied and unoccupied beds. After the dataset was cleaned for entries with empty values and invalid negative values, all entries in the remaining set were shown to adhere to these relations when tested.

The R Programming language [@citeR] was used for all data cleaning, testing, and analysis. The packages `opendatatoronto` [@opendatatoronto], `tidyverse` [@citeTidyverse], `dplyr` [@citeDplyr], and `readr` [@citeReadr] were used to simulate and download data. Packages `tidyverse` [@citeTidyverse] and `janitor` [@citeJanitor] were then used to clean and test the downloaded dataset.

## Results {#data-findings}

(# check if occupancy rate varies over months
```{r}
#| label: tbl-occupancyrate-vs-month
#| tbl-cap: Shelter Occupancy Rate in 2024 Over the Months
#| echo: false

rate_means <- data %>% select(month, occupancy_rate, funding_capacity) %>% group_by(month) %>% 
  summarise(mean_occupancy_rate = mean(occupancy_rate), mean_capacity = mean(funding_capacity))

rate_means$month <- month.abb[rate_means$month]
  
knitr::kable(rate_means, align ="c", col.names= c("Month", "Mean Occupancy Rate", "Mean Funding Capacity"))

```



(#first find num shelters per fsa
```{r}
#| label: fig-fsa-numshelters
#| eval: true
#| tbl-cap: "Number of Unique Shelters vs FSA"
#| echo: false

fsa_shelters <- data %>% select(fsa, location_id) %>% group_by(fsa) %>% 
  summarise(numshelters = n_distinct(location_id))

fsa_shelters <- fsa_shelters[order(fsa_shelters$numshelters, decreasing = TRUE), ]
knitr::kable(top_n(fsa_shelters,5,numshelters), align ="c", col.names= c("FSA", "Number of Shelter Locations"))

```
```{r}
#| label: fig-numshelters-vs-fsa
#| fig-cap: Number of Shelters in Each FSA
#| echo: false

hist(fsa_shelters$numshelters)
```

```{r}
#| label: fig-regionoccupancy
#| fig-cap: Average Bed Occupancy of Shelters Across Different FSA Regions
#| echo: false

region_occupancy <- data %>% select(fsa, occupied_beds) %>% group_by(fsa) %>%
  summarise(mean_occupied = mean(occupied_beds))

hist(region_occupancy$mean_occupied)

```
```{r}
#| label: fig-fundingcapacity-histogram
#| fig-cap: "Funding Capacities of Toronto Emergency Shelters"
#| echo: false

hist(data$funding_capacity)
```

(#discuss summary stats of funding capacity in text, can consider to only include top few rows of this table
```{r}
#| label: fig-fsa-fundingcapacity
#| eval: true
#| tbl-cap: "Funding Capacities of Toronto Emergency Shelters"
#| echo: false

funding_means <- data %>% select(fsa, funding_capacity) %>% group_by(fsa) %>% 
  summarise(mean_fundingcap = mean(funding_capacity))

funding_means <- funding_means[order(funding_means$mean_fundingcap, decreasing = TRUE), ]

#knitr::kable(top_n(funding_means,5,mean_fundingcap), align ="c", col.names= c("FSA", "Mean Funding Capacity"))
hist(funding_means$mean_fundingcap)
```

```{r}
#| label: fig-unavailabilities-by-fsa
#| eval: true
#| tbl-cap: "Number of Unavailable Beds/Night At Different FSAs"
#| echo: false

unavailable_beds <- data %>% select(fsa, unavailable_beds) %>% group_by(fsa) %>% 
  summarise(mean_unavailable = mean(unavailable_beds))

unavailable_beds <- unavailable_beds[order(unavailable_beds$mean_unavailable, decreasing = TRUE), ]

knitr::kable(top_n(unavailable_beds,5,unavailable_beds$mean_unavailable), 
             align ="c", col.names= c("FSA", "Average Number of Unavailable Beds"))
#hist(unavailable_beds$mean_unavailable)
```


# Discussion {#sec-discussion}
Additionally, the distribution of shelter locations across the city's different forward sortation areas (FSA), or the first three digits of a zip code, displays that there are particular areas with higher demand than others. For example, particular blocks in Old Toronto are evidently areas that require higher attention, as they are among the FSAs to receive most funding as well as the ones that have highest number of shelters (#cite dataset).

## First discussion point {#sec-first-point}

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {#sec-appendix}
## Data License Information {#sec-license}
"Contains information licensed under the Open Government Licence â€“ Toronto" [@tphlicense].
# Additional data details



\newpage


# References